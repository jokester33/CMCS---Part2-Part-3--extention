@model CMCS.Models.Claim
@{
    ViewData["Title"] = "Submit Monthly Claim";
}

<div class="container mt-5">
    <h2 class="text-center mb-4">Submit Monthly Claim</h2>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success text-center">@TempData["Success"]</div>
    }

    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

    <form asp-action="SubmitClaim" method="post" enctype="multipart/form-data">

        <!-- Lecturer Name -->
        <div class="mb-3">
            <label asp-for="LecturerName" class="form-label"></label>
            <input asp-for="LecturerName" class="form-control" required />
        </div>

        <!-- Hours Worked -->
        <div class="mb-3">
            <label asp-for="HoursWorked" class="form-label"></label>
            <input asp-for="HoursWorked" id="HoursWorked" type="number" step="0.1" min="1" class="form-control" required />
        </div>

        <!-- Hourly Rate -->
        <div class="mb-3">
            <label asp-for="HourlyRate" class="form-label"></label>
            <input asp-for="HourlyRate" id="HourlyRate" type="number" step="0.1" min="50" class="form-control" required />
        </div>

        <!-- Auto-calculated Total -->
        <div class="mb-3">
            <label class="form-label">Total Pay (Calculated)</label>
            <input id="totalDisplay" class="form-control" disabled />
        </div>

        <!-- Hidden TotalPay -->
        <input asp-for="TotalPay" id="TotalPay" type="hidden" />

        <!-- Upload -->
        <div class="mb-3">
            <label class="form-label">Supporting Document (optional)</label>
            <input type="file" name="upload" class="form-control" accept=".pdf,.docx,.xlsx" />

        </div>

        <button type="submit" class="btn btn-success w-100">Submit Claim</button>

    </form>
</div>

@section Scripts {
    <script>
        function calculateTotal() {
            const hours = parseFloat(document.getElementById("HoursWorked").value) || 0;
            const rate = parseFloat(document.getElementById("HourlyRate").value) || 0;

            const total = hours * rate;

            document.getElementById("totalDisplay").value = total.toFixed(2);
            document.getElementById("TotalPay").value = total.toFixed(2);
        }

        document.getElementById("HoursWorked").addEventListener("input", calculateTotal);
        document.getElementById("HourlyRate").addEventListener("input", calculateTotal);
    </script>
}
